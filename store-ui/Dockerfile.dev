FROM ghcr.io/loft-sh/devspace-containers/typescript:18-alpine

WORKDIR /app

# Copy package files first for better caching
COPY package*.json ./

# Install dependencies and clean cache in one layer to reduce size
RUN npm ci \
    && npm cache clean --force \
    && rm -rf /tmp/* /var/tmp/*

# Copy the startup script
COPY devspace_start.sh ./

# Make devspace_start.sh executable
RUN chmod +x devspace_start.sh